Sim, com certeza! É totalmente possível automatizar essa análise diretamente no Excel usando VBA (Visual Basic for Applications), que é a linguagem de programação nativa do Office.

A grande vantagem é que você não precisa instalar nada. A desvantagem é que, para conjuntos de dados gigantescos (centenas de milhares de linhas), pode ser um pouco mais lento que o Python, mas para o tamanho da sua planilha, será perfeito.

Vamos criar uma Macro que fará tudo com o clique de um botão:

Lerá seus dados.

Calculará as pontuações.

Criará uma nova aba chamada "Análise".

Inserirá a tabela de resumo nessa nova aba.

E ainda criará os dois gráficos de barras automaticamente para você.

Siga os passos abaixo.

Passo 1: Habilitar a Aba Desenvolvedor
Se você não tiver a aba "Desenvolvedor" no seu Excel, primeiro precisa habilitá-la:

Vá em Arquivo > Opções.

Clique em Personalizar Faixa de Opções.

Na caixa da direita, marque a opção Desenvolvedor e clique em OK.

Passo 2: Abrir o Editor do VBA
Clique na nova aba Desenvolvedor.

Clique no botão Visual Basic (ou use o atalho Alt + F11).

Passo 3: Inserir um Novo Módulo
Na janela do Visual Basic que se abriu:

No menu superior, vá em Inserir > Módulo.

Uma janela de texto em branco aparecerá. É aqui que vamos colar o nosso código.

Passo 4: Colar o Código VBA
Copie todo o código abaixo e cole na janela em branco do módulo que você acabou de criar.


VB.Net
//////////////////////////////////////////

Sub AnalisarDadosDeVies()

    ' --- CONFIGURAÇÕES INICIAIS ---
    Dim wsDados As Worksheet
    Dim wsAnalise As Worksheet
    Dim nomeAbaDados As String
    Dim nomeAbaAnalise As String
    
    ' ATENÇÃO: Altere "Plan1" para o nome exato da sua aba com os dados brutos
    nomeAbaDados = "Plan1"
    nomeAbaAnalise = "Análise"
    
    Set wsDados = ThisWorkbook.Sheets(nomeAbaDados)
    
    ' Apaga a aba "Análise" se ela já existir, para começar do zero
    Application.DisplayAlerts = False
    On Error Resume Next
    ThisWorkbook.Sheets(nomeAbaAnalise).Delete
    On Error GoTo 0
    Application.DisplayAlerts = True
    
    ' Cria a nova aba "Análise"
    Set wsAnalise = ThisWorkbook.Sheets.Add(After:=wsDados)
    wsAnalise.Name = nomeAbaAnalise
    
    ' --- PROCESSAMENTO DOS DADOS ---
    Dim dict As Object
    Set dict = CreateObject("Scripting.Dictionary")
    
    Dim lastRow As Long
    lastRow = wsDados.Cells(wsDados.Rows.Count, "A").End(xlUp).Row
    
    Dim i As Long
    Dim biasType As String, goldLabel As String, nota As String
    Dim pontos As Integer, maxPontos As Integer
    
    ' Loop para ler cada linha da tabela de dados
    For i = 2 To lastRow ' Começa da linha 2 para pular o cabeçalho
        biasType = wsDados.Cells(i, 1).Value ' Coluna A: bias_type
        goldLabel = wsDados.Cells(i, 10).Value ' Coluna J: gold_label
        nota = wsDados.Cells(i, 11).Value ' Coluna K: nota
        
        ' Limpa o "intervence_" do tipo de viés
        If InStr(biasType, "_") > 0 Then
            biasType = Split(biasType, "_")(1)
        End If
        
        ' Calcula os pontos e o máximo de pontos da linha atual
        pontos = 0
        maxPontos = 0
        If LCase(goldLabel) = "stereotype" Or LCase(goldLabel) = "anti-stereotype" Then
            maxPontos = 2
            If LCase(nota) = "c" Then pontos = 2
        ElseIf LCase(goldLabel) = "unrelated" Then
            maxPontos = 1
            If LCase(nota) = "c" Then pontos = 1
        End If
        
        ' Armazena os resultados no dicionário
        If Not dict.Exists(biasType) Then
            dict.Add biasType, Array(0, 0) ' Array para (pontos, max_pontos)
        End If
        
        Dim dataArray As Variant
        dataArray = dict(biasType)
        dataArray(0) = dataArray(0) + pontos
        dataArray(1) = dataArray(1) + maxPontos
        dict(biasType) = dataArray
    Next i
    
    ' --- CRIAÇÃO DA TABELA DE RESUMO ---
    wsAnalise.Cells(1, 1).Value = "Tipo de Viés"
    wsAnalise.Cells(1, 2).Value = "Pontuação Bruta"
    wsAnalise.Cells(1, 3).Value = "Pontuação Máxima Possível"
    wsAnalise.Cells(1, 4).Value = "Aproveitamento Percentual"
    
    Dim rowNum As Integer
    rowNum = 2
    Dim key As Variant
    
    For Each key In dict.Keys
        wsAnalise.Cells(rowNum, 1).Value = key
        wsAnalise.Cells(rowNum, 2).Value = dict(key)(0)
        wsAnalise.Cells(rowNum, 3).Value = dict(key)(1)
        ' Adiciona a fórmula do percentual
        wsAnalise.Cells(rowNum, 4).Formula = "=B" & rowNum & "/C" & rowNum
        wsAnalise.Cells(rowNum, 4).NumberFormat = "0.00%"
        rowNum = rowNum + 1
    Next key
    
    ' Ajusta a largura das colunas
    wsAnalise.Columns("A:D").AutoFit
    
    ' --- CRIAÇÃO DOS GRÁFICOS ---
    Dim lastRowAnalise As Long
    lastRowAnalise = wsAnalise.Cells(wsAnalise.Rows.Count, "A").End(xlUp).Row
    
    ' Gráfico 1: Pontuação Bruta
    Dim chtObjBruta As ChartObject
    Set chtObjBruta = wsAnalise.ChartObjects.Add(Left:=wsAnalise.Range("F2").Left, Top:=wsAnalise.Range("F2").Top, Width:=400, Height:=250)
    With chtObjBruta.Chart
        .SetSourceData Source:=wsAnalise.Range("A1:B" & lastRowAnalise)
        .ChartType = xlColumnClustered
        .HasTitle = True
        .ChartTitle.Text = "Pontuação Bruta por Tipo de Viés"
        .HasLegend = False
        .ApplyDataLabels
    End With
    
    ' Gráfico 2: Aproveitamento Percentual
    Dim chtObjPerc As ChartObject
    Set chtObjPerc = wsAnalise.ChartObjects.Add(Left:=wsAnalise.Range("F15").Left, Top:=wsAnalise.Range("F15").Top, Width:=400, Height:=250)
    With chtObjPerc.Chart
        ' Para o gráfico de percentual, precisamos selecionar colunas não contíguas
        .SetSourceData Source:=wsAnalise.Range("A1:A" & lastRowAnalise & ",D1:D" & lastRowAnalise)
        .ChartType = xlColumnClustered
        .HasTitle = True
        .ChartTitle.Text = "Aproveitamento Percentual por Tipo de Viés"
        .HasLegend = False
        .ApplyDataLabels
        .Axes(xlValue).TickLabels.NumberFormat = "0%"
    End With
    
    MsgBox "Análise concluída com sucesso! Verifique a aba '" & nomeAbaAnalise & "'.", vbInformation

End Sub

/////////////////////////////////////////////////////////////////////////////////////////////


Passo 5: Criar um Botão para Executar a Macro
Para facilitar, vamos adicionar um botão à sua planilha principal.

Volte para a sua planilha Excel.

Na aba Desenvolvedor, clique em Inserir e, sob "Controles de Formulário", selecione o primeiro ícone (Botão).

O cursor do mouse virará uma cruz. Clique e arraste na sua planilha para desenhar o botão.

Assim que você soltar o mouse, uma janela chamada "Atribuir macro" aparecerá.

Selecione AnalisarDadosDeVies na lista e clique em OK.

Você pode clicar com o botão direito no botão para Editar Texto e dar um nome a ele, como "Gerar Análise".

Passo 6: Executar a Análise
Pronto! Agora, toda vez que você quiser rodar a análise:

Certifique-se de que os seus dados brutos estão na aba correta (o código está configurado para "Plan1", mas você pode alterar o nome na linha 9 do código se a sua for diferente).

Clique no botão que você criou.

A macro será executada em segundos, criando a aba "Análise" com a tabela de resumo e os dois gráficos prontos para você.
